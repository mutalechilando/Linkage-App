"use strict";

var _steps = require("cypress-cucumber-preprocessor/steps");

(0, _steps.Given)('a "{word}" calendar is rendered with a selected date "{word}"', (calendar, initialDate) => {
  cy.visitStory('CalendarInputTesting', 'Test Calendar With Clear Button', {
    qs: {
      initialDate,
      calendar
    }
  });
  cy.get('[data-test="storybook-calendar-date-value"]').should('have.text', initialDate);
});
(0, _steps.Then)('we should be able to clear it', () => {
  cy.get("[data-test=\"calendar-clear-button\"]").click();
  cy.get('[data-test="storybook-calendar-date-value"]').should('have.text', 'undefined');
});
(0, _steps.And)('show the current month afterwards', () => {
  cy.get('[data-test="dhis2-uiwidgets-calendar-inputfield"]').click();
  cy.get('.isToday').should('be.visible');
});
(0, _steps.And)("allow selecting today's date", () => {
  cy.get('.isToday').parent().invoke('attr', 'data-test').then(todayDate => {
    cy.get('.isToday').click();
    cy.get('[data-test="storybook-calendar-date-value"]').should('have.text', todayDate);
    cy.get('[data-test="dhis2-uiwidgets-calendar-inputfield"] input').should('have.value', todayDate);
  });
});
(0, _steps.And)('highlight today as the selected date', () => {
  cy.get('[data-test="dhis2-uiwidgets-calendar-inputfield"]').click();
  cy.get('.isToday').parent().invoke('attr', 'data-test').then(todayDate => {
    cy.get('.isSelected').should('have.text', Number(todayDate.split('-')[2]).toString());
  });
});